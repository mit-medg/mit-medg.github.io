<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bibliography of MIT CSAIL Clinical Decision Making Group (MEDG) Publications</title>
<style>
:root{--fg:#0f172a;--muted:#475569;--bg:#f8fafc;--card:#fff;--accent:#0ea5e9}
html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
header{position:sticky;top:0;background:rgba(248,250,252,.85);backdrop-filter:saturate(180%) blur(6px);border-bottom:1px solid #e2e8f0}
.wrap{max-width:1000px;margin:0 auto;padding:18px}
h1{font-size:1.4rem;margin:0 0 6px 0}
.muted{color:var(--muted)}
main{max-width:1000px;margin:24px auto;padding:0 18px 48px}
.card{background:#fff;border:1px solid #e2e8f0;border-radius:16px;box-shadow:0 2px 10px rgba(2,6,23,.06);padding:18px}
.filters{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:8px;margin-bottom:8px;width:100%}
.filters .field{display:flex;flex-direction:column;gap:4px;position:relative;min-width:0}
.filters label{font-size:.8rem;color:var(--muted)}
.filters input{border:1px solid #cbd5e1;border-radius:10px;padding:8px 28px 8px 10px;font-size:.95rem;width:100%}
.filters .thesis-only{display:none}
.clear-btn{position:absolute;right:8px;top:50%;transform:translateY(-50%);cursor:pointer;font-weight:700;color:red;font-size:1rem;display:none;user-select:none}
.field input:not(:placeholder-shown)+.clear-btn{display:block}
ol{counter-reset:item;list-style:none;padding-left:0}
li{counter-increment:item;background:#fff;border:1px solid #e2e8f0;border-radius:10px;padding:4px 6px;margin:2px 0}
li::before{content:counter(item) ". ";font-weight:600;margin-right:6px}
li.group{counter-increment:none;background:transparent;border:none;padding:0;margin:10px 0 2px;font-weight:700;font-size:1.05rem}
li.group::before{content:'';margin:0}
.small{font-size:.9rem}
.error{background:#fef2f2;border:1px solid #fecaca;color:#991b1b;padding:6px 10px;border-radius:8px;margin-top:8px}
*{box-sizing:border-box}
</style></head>
<body>
<header><div class="wrap"><h1>Bibliography of MIT CSAIL Clinical Decision Making Group (MEDG) Publications</h1></div></header>
<main>
  <div class="card">
    <div id="filters" class="filters">
      <div class="field"><label for="f-name">Name</label><input id="f-name" type="text" placeholder="e.g., Patil"/><span class="clear-btn" data-target="f-name">☒</span></div>
      <div class="field"><label for="f-title">Title</label><input id="f-title" type="text" placeholder="e.g., learning"/><span class="clear-btn" data-target="f-title">☒</span></div>
      <div class="field thesis-only"><label for="f-sup">Supervisor</label><input id="f-sup" type="text" placeholder="e.g., Szolovits"/><span class="clear-btn" data-target="f-sup">☒</span></div>
      <div class="field thesis-only"><label for="f-rdr">Reader</label><input id="f-rdr" type="text" placeholder="e.g., Kohane"/><span class="clear-btn" data-target="f-rdr">☒</span></div>
    </div>
    <div id="status" class="small muted" style="margin-top:10px"></div>
    <div id="err" class="error" style="display:none"></div>
  </div>
  <ol id="output"></ol>
</main>
<script>
const statusEl=document.getElementById('status'),errorEl=document.getElementById('err'),outputEl=document.getElementById('output'),filtersEl=document.getElementById('filters');
const inName=()=>document.getElementById('f-name'),inTitle=()=>document.getElementById('f-title'),inSup=()=>document.getElementById('f-sup'),inRdr=()=>document.getElementById('f-rdr');
function status(h){if(statusEl)statusEl.innerHTML=h}
function showError(e){if(!errorEl)return;errorEl.style.display='block';const m=(e&&e.message)?e.message:String(e);errorEl.innerHTML=`⚠️ ${escapeHtml(m)}<div class="small">Tip: If this page is opened via <code>file:///</code>, browsers block <code>fetch</code>. Serve locally (e.g., <code>python3 -m http.server</code>).</div>`;console.error(e)}
const bibFiles=["bib/psz.bib","bib/MEDG_theses.bib","bib/emily.bib","bib/jindi.bib","bib/mmd.bib","bib/ckbjimmy.bib","bib/stmharry.bib","bib/symin95.bib","bib/gupta.bib","bib/wjl.bib","bib/medg.bib"];
function getFilters(){try{const p=new URLSearchParams(window.location.search);const g=v=>v&&v.trim()?v.trim():'';return{name:g(p.get('name')),title:g(p.get('title')),supervisor:g(p.get('supervisor')),reader:g(p.get('reader'))}}catch{return{name:'',title:'',supervisor:'',reader:''}}}
let currentEntries=[],allEntries=[],hasThesisType=false,filtersInitialized=false,initialUrlFilters={name:'',title:'',supervisor:'',reader:''};
window.addEventListener('DOMContentLoaded',()=>{try{status('Initializing…')}catch{} initialUrlFilters=getFilters();setupLiveFilters(false);loadAll().catch(showError);document.querySelectorAll('.clear-btn').forEach(btn=>{btn.addEventListener('click',()=>{const id=btn.getAttribute('data-target');const inp=document.getElementById(id);if(inp){inp.value='';inp.dispatchEvent(new Event('input', { bubbles: true }));inp.dispatchEvent(new Event('change', { bubbles: true }));}})})});
async function loadAll(){status('Fetching bib files…');if(errorEl)errorEl.style.display='none';let entries=[],failed=[];for(const f of bibFiles){try{const res=await fetch(f,{cache:'no-store'});if(!res.ok)throw new Error(`${f} (HTTP ${res.status})`);const txt=await res.text();entries=entries.concat(parseBibtex(txt))}catch(e){failed.push({file:f,error:e.message||String(e)});console.warn('Failed to load',f,e)}}const map=new Map();for(const e of entries){const k=String(e.key||'').toLowerCase();if(!k)continue;if(!map.has(k))map.set(k,e)}entries=Array.from(map.values());allEntries=entries;hasThesisType=entries.some(e=>/^(phdthesis|mastersthesis|thesis)$/i.test(e.type));document.querySelectorAll('.thesis-only').forEach(el=>el.style.display=hasThesisType?'flex':'none');const live={name:inName()?.value?.trim()||initialUrlFilters.name||'',title:inTitle()?.value?.trim()||initialUrlFilters.title||'',supervisor:hasThesisType?(inSup()?.value?.trim()||initialUrlFilters.supervisor||''):'',reader:hasThesisType?(inRdr()?.value?.trim()||initialUrlFilters.reader||''):''};const filtered=applyFilters(entries,live);currentEntries=filtered;let msg=`<strong>${filtered.length}</strong> entries shown`;const esc=escapeHtml;if(live.name)msg+=` — name: <code>${esc(live.name)}</code>`;if(live.title)msg+=` — title: <code>${esc(live.title)}</code>`;if(live.supervisor)msg+=` — supervisor: <code>${esc(live.supervisor)}</code>`;if(live.reader)msg+=` — reader: <code>${esc(live.reader)}</code>`;if(failed.length){const parts=failed.map(f=>`${esc(f.file)} (${esc(f.error)})`).join('; ');msg+=`<div class="small" style="color:#991b1b">Failed: ${parts}</div>`}status(msg);render(filtered)}
function setupLiveFilters(toggleThesisNow=true){if(!filtersEl){console.warn('[filters] missing container');return}filtersEl.style.display='grid';filtersEl.removeAttribute('hidden');filtersEl.setAttribute('aria-hidden','false');const fName=inName();if(fName)fName.value=initialUrlFilters.name||'';const fTitle=inTitle();if(fTitle)fTitle.value=initialUrlFilters.title||'';const fSup=inSup();if(fSup)fSup.value=initialUrlFilters.supervisor||'';const fRdr=inRdr();if(fRdr)fRdr.value=initialUrlFilters.reader||'';if(!filtersInitialized){const handler=()=>{const live={name:inName()?.value?.trim()||'',title:inTitle()?.value?.trim()||'',supervisor:hasThesisType?(inSup()?.value?.trim()||''):'',reader:hasThesisType?(inRdr()?.value?.trim()||''):''};const filtered=applyFilters(allEntries,live);currentEntries=filtered;let msg=`<strong>${filtered.length}</strong> entries shown`;const esc=escapeHtml;if(live.name)msg+=` — name: <code>${esc(live.name)}</code>`;if(live.title)msg+=` — title: <code>${esc(live.title)}</code>`;if(live.supervisor)msg+=` — supervisor: <code>${esc(live.supervisor)}</code>`;if(live.reader)msg+=` — reader: <code>${esc(live.reader)}</code>`;status(msg);render(filtered)};['input','keyup','change'].forEach(evt=>filtersEl.addEventListener(evt,handler));requestAnimationFrame(handler);filtersInitialized=true}if(toggleThesisNow){filtersEl.querySelectorAll('.thesis-only').forEach(el=>el.style.display=hasThesisType?'flex':'none')}}
function applyFilters(entries,{name='',title='',supervisor='',reader=''}={}){if(!(name||title||supervisor||reader))return entries.slice();const n=name.toLowerCase(),t=title.toLowerCase(),s=supervisor.toLowerCase(),r=reader.toLowerCase();return entries.filter(e=>{const nameStr=(renderNamesForFilter(e)||'').toLowerCase();const titleStr=((e.fields&&e.fields.title)?e.fields.title:'').replace(/[{}]/g,'').toLowerCase();const supStr=(renderSupervisorsForFilter(e)||'').toLowerCase();const rdrStr=(renderReadersForFilter(e)||'').toLowerCase();return (name?nameStr.includes(n):true)&&(title?titleStr.includes(t):true)&&(supervisor?supStr.includes(s):true)&&(reader?rdrStr.includes(r):true)})}
function render(entries){const exploring=[],inProg=[],dated=[],unknown=[];for(const e of entries){const g=groupRank(e);if(g===0){exploring.push(e);continue}if(g===1){inProg.push(e);continue}const y=parseInt(e.fields.year||'0',10)||0;if(y>0)dated.push(e);else unknown.push(e)}const tb=(a,b)=>{const ak=firstAuthorKey(a).localeCompare(firstAuthorKey(b));if(ak!==0)return ak;const t=(a.fields.title||'').localeCompare(b.fields.title||'');if(t!==0)return t;return (a.key||'').localeCompare(b.key||'')};exploring.sort(tb);inProg.sort(tb);dated.sort((a,b)=>{const d=dateScore(b)-dateScore(a);if(d!==0)return d;return tb(a,b)});const byYear=new Map();for(const e of dated){const y=String(parseInt(e.fields.year||'0',10));if(!byYear.has(y))byYear.set(y,[]);byYear.get(y).push(e)}const years=Array.from(byYear.keys()).map(n=>parseInt(n,10)).filter(n=>!Number.isNaN(n)&&n>0).sort((a,b)=>b-a);outputEl.innerHTML='';const addHeader=l=>{const h=document.createElement('li');h.className='group';h.textContent=l;outputEl.appendChild(h)};const addItem=e=>{const li=document.createElement('li');li.innerHTML=formatVancouver(e);outputEl.appendChild(li)};if(exploring.length){addHeader('Exploring');exploring.forEach(addItem)}if(inProg.length){addHeader('In progress');inProg.forEach(addItem)}for(const y of years){addHeader(String(y));byYear.get(String(y)).forEach(addItem)}if(unknown.length){addHeader('Unknown year');unknown.sort(tb).forEach(addItem)}}
function parseBibtex(text){text=text.replace(/^\s*%.*$/gm,'');const out=[];const rx=/@([a-zA-Z]+)\s*\{\s*([^,]+)\s*,([\s\S]*?)\}\s*(?=@|$)/g;let m;while((m=rx.exec(text))){const type=(m[1]||'').toLowerCase();const key=(m[2]||'').trim();const body=(m[3]||'');out.push({type,key,fields:parseFields(body)})}return out}
function parseFields(body){const out={};let i=0,token='';let depth=0,inQ=false;const parts=[];while(i<body.length){const c=body[i];if(c==='"'&&body[i-1]!=="\\"){inQ=!inQ;token+=c;i++;continue}if(c==='{'&&!inQ){depth++;token+=c;i++;continue}if(c==='}'&&!inQ&&depth>0){depth--;token+=c;i++;continue}if(c===','&&!inQ&&depth===0){parts.push(token);token='';i++;continue}token+=c;i++}if(token.trim())parts.push(token);for(const p of parts){const kv=p.split(/\s*=\s*/);if(kv.length<2)continue;const k=kv.shift().trim().toLowerCase();const v=kv.join('=').trim();out[k]=unbrace(unquote(v)).replace(/\s+/g,' ').trim()}return out}
function unquote(s){if((s.startsWith('"')&&s.endsWith('"'))||(s.startsWith("'")&&s.endsWith("'")))return s.slice(1,-1);return s}
function unbrace(s){let changed=true;while(changed){changed=false;if(s.startsWith('{')&&s.endsWith('}')){let d=0,ok=true;for(let i=0;i<s.length;i++){const c=s[i];if(c=='{')d++;if(c=='}')d--;if(d===0&&i<s.length-1){ok=false;break}}if(ok){s=s.slice(1,-1);changed=true}}}return s}
function formatVancouver(entry){const f=entry.fields||{};const isTh=/^(phdthesis|mastersthesis|thesis)$/i.test(entry.type);let people='';const strip=s=>(s||'').replace(/[{}]/g,'');if(f.author&&f.author.trim()){people=isTh?formatAuthors(strip(f.author),{abbr:false,full:true}):formatAuthors(strip(f.author),{abbr:true})}else if(f.editor&&f.editor.trim()){const raw=strip(f.editor);let ed=isTh?formatAuthors(raw,{abbr:false,full:true}):formatAuthors(raw,{abbr:true});ed=ed.replace(/[.]\s*$/,'');const cnt=(raw||'').split(/\s+and\s+/i).map(s=>s.trim()).filter(Boolean).length;people=ed+(cnt>1?' (editors).':' (editor).')}const rawTitle=(f.title||'').trim();const cleanTitle=rawTitle.replace(/[{}]/g,'');const title=ensurePeriod(cleanTitle).trim();const doiClean=cleanDoi(f.doi||'');if(doiClean)f.doi=doiClean;const link=(f.url&&f.url.trim())?f.url.trim():(doiClean?('https://doi.org/'+doiClean):'');const baseRaw=isTh?(f.school||f.institution||''):(entry.type==='techreport'?(f.institution||''):(f.journal||f.booktitle||f.publisher||''));const base=(baseRaw||'').replace(/[{}]/g,'').trim();const year=(f.year||'').trim();const volume=(f.volume||'').trim();const number=(f.number||f.issue||'').trim();const pages=(f.pages||'').replace(/--/g,'-').trim();let line='';if(people)line+=people+' ';if(title){line+=link?`<a href="${escapeAttr(link)}" target="_blank" rel="noopener noreferrer"><strong>${escapeHtml(title)}</strong></a> `:`<strong>${escapeHtml(title)}</strong> `}
{let prefix='',mid='',container=base;if(entry.type==='inbook'){const ba=strip(f.bookauthor);if(ba&&ba.trim()){prefix=formatAuthors(ba,{abbr:true});prefix=prefix.replace(/\.$/,'')+', '}else if(f.editor&&f.editor.trim()){const raw=strip(f.editor);let ed=formatAuthors(raw,{abbr:true});ed=ed.replace(/\.$/,'');const cnt=(raw||'').split(/\s+and\s+/i).map(s=>s.trim()).filter(Boolean).length;prefix=ed+(cnt>1?' (editors),':' (editor),')+' '}}if(entry.type==='techreport'){const repType=(f.type||'Technical Report').replace(/[{}]/g,'').trim();const repNum=((f.number||f.reportnumber||'')+'').trim();if(repType||repNum)mid=`${escapeHtml(repType)}${repNum?' '+escapeHtml(repNum):''}. `;const inst=(f.institution||'').replace(/[{}]/g,'').trim();if(inst)container=inst}const cont=container?`<em>${escapeHtml(container)}</em> `:'';if(prefix||mid||cont)line+=`${prefix}${mid}${cont}`}
const tail=[];if(year)tail.push(year);if(volume){let v=volume;if(number)v+=`(${number})`;tail.push(v)}if(pages)tail.push(pages.replace(/^p\.?\s*/i,''));if(tail.length){const y=tail.shift();const rest=tail.join(':');line+=rest?`${y};${rest}. `:`${y}. `}
if(isTh){const t=(f.type&&f.type.trim())?f.type:(entry.type.toLowerCase()==='phdthesis'?'PhD Thesis':entry.type.toLowerCase()==='mastersthesis'?"Master's Thesis":'Thesis');line+=` ${escapeHtml(t)}.`;const sup=f.supervisor?formatPersonListGivenFirst(strip(f.supervisor)):'';const rdr=f.reader?formatPersonListGivenFirst(strip(f.reader)):'';if(sup){const n=(f.supervisor||'').split(/\s+and\s+/i).filter(Boolean).length;line+=n>1?` Supervisors: ${escapeHtml(sup)}.`:` Supervisor: ${escapeHtml(sup)}.`}if(rdr){const n=(f.reader||'').split(/\s+and\s+/i).filter(Boolean).length;line+=n>1?` Readers: ${escapeHtml(rdr)}.`:` Reader: ${escapeHtml(rdr)}.`}}
return line.trim()}
function renderNamesForFilter(entry){const f=entry.fields||{};const isTh=/^(phdthesis|mastersthesis|thesis)$/i.test(entry.type);const strip=s=>(s||'').replace(/[{}]/g,'');if(f.author&&f.author.trim())return (isTh?formatAuthors(strip(f.author),{abbr:false,full:true}):formatAuthors(strip(f.author),{abbr:true})).replace(/[.]\s*$/,'');if(f.editor&&f.editor.trim())return (isTh?formatAuthors(strip(f.editor),{abbr:false,full:true}):formatAuthors(strip(f.editor),{abbr:true})).replace(/[.]\s*$/,'');return ''}
function renderSupervisorsForFilter(entry){const f=entry.fields||{};const strip=s=>(s||'').replace(/[{}]/g,'');if(!f.supervisor)return '';return formatPersonListGivenFirst(strip(f.supervisor))}
function renderReadersForFilter(entry){const f=entry.fields||{};const strip=s=>(s||'').replace(/[{}]/g,'');if(!f.reader)return '';return formatPersonListGivenFirst(strip(f.reader))}
function ensurePeriod(s){s=s.trim();if(!s)return s;return /[.!?]\s*$/.test(s)?s:s+'.'}
function formatAuthors(field,{abbr=true,full=false}={}){if(!field)return '';const parts=field.split(/\s+and\s+/i).map(s=>s.trim()).filter(Boolean);const names=parts.map(fmtOne);const list=names.join(', ');return list?list+'.':'';function fmtOne(name){const clean=(name||'').replace(/[{}]/g,'').trim();if(clean.includes(',')){const [last,givenRaw]=clean.split(',').map(x=>x.trim());const given=givenRaw||'';if(full)return `${given} ${last}`.replace(/\s+/g,' ').trim();const init=givenToInitials(given,abbr);return init?`${last} ${init}`:last}else{const bits=clean.split(/\s+/).filter(Boolean);if(bits.length===1)return bits[0];const last=bits.pop();const given=bits.join(' ');if(full)return `${given} ${last}`.replace(/\s+/g,' ').trim();const init=givenToInitials(given,abbr);return init?`${last} ${init}`:last}}}
function formatPersonListGivenFirst(field){const parts=(field||'').split(/\s+and\s+/i).map(s=>s.trim()).filter(Boolean);return parts.map(formatPersonGivenFirst).join('; ')}
function formatPersonGivenFirst(name){const clean=(name||'').replace(/[{}]/g,'');if(clean.includes(',')){const a=clean.split(',');const last=(a[0]||'').trim();const given=(a[1]||'').trim();if(!given)return clean.trim();return `${given} ${last}`.replace(/\s+/g,' ').trim()}return clean.replace(/\s+/g,' ').trim()}
function givenToInitials(given,abbr){if(!given)return '';const letters=given.replace(/\([^)]*\)/g,'').replace(/\{[^}]*\}/g,'').split(/[-\s]+/).filter(Boolean).map(w=>w[0]?w[0].toUpperCase():'').join(abbr?'':' ');return letters}
function escapeHtml(s){return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')}
function escapeAttr(s){return String(s).replaceAll('"','&quot;')}
function cleanDoi(s){if(!s)return '';let x=String(s).trim();x=x.replace(/^doi:\s*/i,'');x=x.replace(/^https?:\/\/(dx\.)?doi\.org\//i,'');x=x.replace(/\s+/g,'');x=x.replace(/[<>]/g,'');x=x.replace(/\.$/,'');return x}
function firstAuthorKey(entry){const base=(entry.fields.author&&entry.fields.author.trim())?entry.fields.author:(entry.fields.editor||'');const a=(base||'').split(/\s+and\s+/i)[0]||'';return a.replace(/[{}]/g,'').replace(/[^a-zA-Z,\s-]/g,'').toLowerCase()}
function dateScore(e){const y=parseInt(e.fields.year||'0',10)||0;let m=e.fields.month||'0';const mm={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12};m=(mm[String(m).slice(0,3).toLowerCase()]||parseInt(m,10)||0);const d=parseInt(e.fields.day||'0',10)||0;return y*10000+m*100+d}
function groupRank(e){const isTh=/^(phdthesis|mastersthesis)$/i.test(e.type);if(!isTh)return 3;const f=e.fields||{};const s=[f.status,f.note,f.keywords,f.annote,f.howpublished,f.remark].filter(Boolean).join(' ').toLowerCase();if(/(^|\b)explor(ing|ation)\b/.test(s))return 0;if(/\bin[-\s]*progress\b|\bongoing\b|\bwork\s*in\s*progress\b/.test(s))return 1;const hasYear=!!parseInt(f.year||'0',10);if(!hasYear)return 1;return 2}
window.addEventListener('error',ev=>showError(ev.message||ev.error||'Unknown script error'));
window.addEventListener('unhandledrejection',ev=>showError(ev.reason||'Unhandled promise rejection'));
</script>
</body></html>
